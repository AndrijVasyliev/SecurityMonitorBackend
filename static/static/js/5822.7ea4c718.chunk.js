"use strict";(self.webpackChunk_log4u_admin_frontend=self.webpackChunk_log4u_admin_frontend||[]).push([[5822],{5822:(n,e,o)=>{o.r(e),o.d(e,{default:()=>T});var t=o(45),i=o(9379),l=o(5043),r=o(5604),d=o(5563),s=o(237),a=o(4836),c=o(1081),u=o(9347),v=o(5316),h=o(1906),p=o(8533),f=o(6600),m=o(7353),x=o(7392),w=o(6910),j=o(8612),A=o(1079),g=o(4944),k=o(6431),C=o(7166),E=o(5552),L=o(4133),S=o(9129),b=o(579);const y=["onCLick","clusterer","map","position"],N=l.forwardRef((function(n,e){return(0,b.jsx)(a.A,(0,i.A)({direction:"up",ref:e},n))}));function T(n){var e;let{truckListData:o}=n,t=E.gX,s=E.s_;1===o.length&&o[0].lastLocation&&(t={lat:o[0].lastLocation[0],lng:o[0].lastLocation[1]},s*=2);const[a,y]=l.useState(null),[T,O]=l.useState(""),[R,U]=l.useState(null),[z,F]=l.useState(!1),{refetch:D}=(0,r.I)({queryKey:["truckForMap",T],queryFn:A.k$,keepPreviousData:!0,retry:!1,enabled:!1});l.useEffect((()=>{if(T){F(!0);const n=null===o||void 0===o?void 0:o.find((n=>n.id===T)),e=n&&(null===n||void 0===n?void 0:n.lastLocation);Promise.all([D().then((n=>n.data)),e&&((null===a||void 0===a?void 0:a.geocode({location:{lat:e[0],lng:e[1]}}))||Promise.reject()).then((n=>{const e=(0,L.U)(n.results);return e?(0,S.s)(e.address_components):""}))]).then((n=>{let[e,o]=n;U(e?(0,i.A)((0,i.A)({},e),{},{lastCity:o||""}):null)})).catch((()=>U(null))).finally((()=>F(!1)))}else U(null)}),[T]);const G=()=>{O("")};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(m.A,{component:"main",sx:{flexGrow:1,p:1,height:"100%",width:"100%"},children:[(0,b.jsx)(d.Wrapper,(0,i.A)((0,i.A)({},(0,E.iz)()),{},{render:n=>{const e=(0,g.dh)(),[,o]=(0,g.pn)();return l.useLayoutEffect((()=>(n===d.Status.LOADING&&o(!0),n===d.Status.FAILURE&&e({severity:"error",message:"Error loading maps!"}),n===d.Status.SUCCESS&&y(new window.google.maps.Geocoder),()=>{n===d.Status.LOADING&&o(!1)})),[n]),null}})),a?(0,b.jsx)(I,{center:t,zoom:s,mapId:E.yw,children:(0,b.jsx)(_,{children:o.map((n=>(0,b.jsx)(M,{onCLick:()=>{return e=n.id,void O(e);var e},title:"".concat(n.truckNumber,"\n").concat(n.status),position:{lat:n.lastLocation[0],lng:n.lastLocation[1]}},n.id)))})}):null]}),(0,b.jsxs)(c.A,{open:!!R,TransitionComponent:N,keepMounted:!0,onClose:G,"aria-describedby":"alert-dialog-slide-description",children:[(0,b.jsx)(f.A,{children:(0,b.jsxs)("span",{children:["TRUCK NUMBER:\xa0",(0,b.jsx)("a",{href:"./trucks/view/".concat(null===R||void 0===R?void 0:R.id),target:"_blank",children:null===R||void 0===R?void 0:R.truckNumber})]})}),(0,b.jsxs)(v.A,{children:[(0,b.jsx)(p.A,{id:"truck-status",children:"CURRENT STATUS: ".concat(null===R||void 0===R?void 0:R.status)}),(0,b.jsx)(p.A,{id:"main-contact",children:(0,b.jsxs)("span",{children:["MAIN CONTACT: ",(0,b.jsx)("b",{children:"".concat(null!==R&&void 0!==R&&R.coordinator||null!==R&&void 0!==R&&R.owner?(0,k.Pw)((null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner)):"")})," ".concat(null!==R&&void 0!==R&&R.coordinator||null!==R&&void 0!==R&&R.owner?((null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner)).fullName:""),(0,b.jsx)(x.A,{size:"small",onClick:n=>{var e;(0,C.d)(n),navigator.clipboard.writeText(" ".concat(null!==R&&void 0!==R&&R.coordinator||null!==R&&void 0!==R&&R.owner?((null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner)).fullName:""," ").concat((null===(e=(null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner))||void 0===e?void 0:e.phone)||""))},children:(0,b.jsx)(w.A,{sx:{height:"16px",width:"16px"}})})]})}),(0,b.jsx)(p.A,{id:"main-contact-number",children:(0,b.jsxs)("span",{children:["MAIN CONTACT #: ",(0,b.jsx)("a",{href:null!==R&&void 0!==R&&R.coordinator||null!==R&&void 0!==R&&R.owner?"tel:".concat(((null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner)).phone):void 0,target:"_blank",onClick:C.d,children:(null===(e=(null===R||void 0===R?void 0:R.coordinator)||(null===R||void 0===R?void 0:R.owner))||void 0===e?void 0:e.phone)||""})]})}),(0,b.jsx)(p.A,{id:"last-location",children:(0,b.jsxs)("span",{children:["LAST LOCATION #: ".concat(null===R||void 0===R?void 0:R.lastCity),(0,b.jsx)(x.A,{size:"small",onClick:n=>{(0,C.d)(n),navigator.clipboard.writeText("".concat(null===R||void 0===R?void 0:R.lastCity))},children:(0,b.jsx)(w.A,{sx:{height:"16px",width:"16px"}})})]})})]}),(0,b.jsx)(u.A,{children:(0,b.jsx)(h.A,{onClick:G,children:"Close"})})]}),(0,b.jsx)(j.A,{visible:z})]})}function I(n){let{center:e,zoom:o,mapId:t,children:i}=n;const r=l.useRef(null),[d,s]=l.useState();l.useEffect((()=>{r.current&&!d&&s(new window.google.maps.Map(r.current,{center:e,zoom:o,mapId:t}))}),[r,d]);const a=l.Children.only(i);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{height:"100%",width:"100%"},ref:r,id:"map"}),l.isValidElement(a)&&l.cloneElement(a,{map:d})]})}function _(n){let{map:e,children:o}=n;const[t,i]=l.useState();return l.useEffect((()=>{if(!t&&e){const n=new s.w1({});n.setMap(e),i(n)}}),[e,t]),l.useEffect((()=>{t&&t.render()}),[e,o,t]),null===t||void 0===t||t.render(),(0,b.jsx)(b.Fragment,{children:l.Children.map(o,(n=>{if(l.isValidElement(n))return l.cloneElement(n,{map:e,clusterer:t})}))})}const M=n=>{const{onCLick:e,clusterer:o,map:i,position:r}=n,d=(0,t.A)(n,y),[s,a]=l.useState();return l.useEffect((()=>{if(!s){const n=new window.google.maps.marker.AdvancedMarkerElement;a(n),n.addListener("click",e)}}),[s]),l.useEffect((()=>{s&&(s.map=i||null)}),[s,i]),l.useEffect((()=>{s&&(s.position=r)}),[s,r&&"".concat(null===r||void 0===r?void 0:r.lat,",").concat(null===r||void 0===r?void 0:r.lng)]),l.useEffect((()=>{s&&(null===o||void 0===o||o.addMarker(s,!1))}),[s,o]),l.useEffect((()=>{s&&Object.assign(s,d)}),[s,d]),null}}}]);
//# sourceMappingURL=5822.7ea4c718.chunk.js.map